<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kayler AI å¡ç‰‡ç”Ÿæˆå™¨</title>
    <script src="layout.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        /* ========================================
        å…¨å±€å˜é‡å®šä¹‰ (CSS Variables)
        ========================================
        */
        :root {
            --primary-color: #2563eb;
            /* ä¸»è‰²è°ƒ (è“è‰²) */
            --bg-color: #f8fafc;
            /* é¡µé¢èƒŒæ™¯è‰² (æµ…ç°) */
            --text-color: #1e293b;
            /* ä¸»è¦æ–‡å­—é¢œè‰² (æ·±è“ç°) */
            --border-color: #e2e8f0;
            /* è¾¹æ¡†é¢œè‰² (æµ…ç°) */
            --card-bg: #ffffff;
            /* å¡ç‰‡èƒŒæ™¯è‰² (çº¯ç™½) */
            --success-color: #10b981;
            /* æˆåŠŸæç¤ºè‰² (ç»¿è‰²) */
        }

        /* ========================================
        åŸºç¡€æ ·å¼é‡ç½® (Reset & Base Styles)
        ========================================
        */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            /* ä¸ºå›ºå®šåœ¨é¡¶éƒ¨çš„å¯¼èˆªæ ç•™å‡ºç©ºé—´ */
            padding-top: 60px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ========================================
        ä¸»å¸ƒå±€å®¹å™¨ (Main Layout)
        ========================================
        */
        .main-container {
            flex: 1;
            /* å æ®é™¤å¯¼èˆªå’Œé¡µè„šå¤–çš„å‰©ä½™ç©ºé—´ */
            display: flex;
            height: calc(100vh - 60px - 50px);
            /* è®¡ç®—é«˜åº¦ï¼šæ€»é«˜ - å¯¼èˆªæ  - é¡µè„š */
            /* å·¦å³æ ä¹‹é—´çš„é—´è·ï¼Œç¼©å°è‡³ 12px (çº¦ 3mm) */
            gap: 12px;
            padding: 20px;
            max-width: 1400px;
            /* é¡µé¢æœ€å¤§å®½åº¦ */
            margin: 0 auto;
            /* å±…ä¸­æ˜¾ç¤º */
            width: 100%;
        }

        /* ========================================
        å·¦ä¾§ç¼–è¾‘åŒº (Left Column - Editor)
        ========================================
        */
        .left-column {
            flex: 1;
            /* å æ®ä¸€åŠå®½åº¦ */
            background: var(--card-bg);
            border-radius: 16px;
            /* åœ†è§’ */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            /* é˜´å½± */
            padding: 24px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            /* å†…å®¹è¿‡å¤šæ—¶å‚ç›´æ»šåŠ¨ */
        }

        .input-group {
            margin-bottom: 24px;
        }

        .input-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }

        /* æ–‡æœ¬è¾“å…¥æ¡†å’Œæ–‡æœ¬åŸŸæ ·å¼ */
        input[type="text"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input[type="text"]:focus,
        textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
            outline: none;
        }

        textarea {
            resize: vertical;
            /* ä»…å…è®¸å‚ç›´æ‹‰ä¼¸ */
            min-height: 100px;
        }

        /* ========================================
        å³ä¾§é¢„è§ˆåŒº (Right Column - Preview)
        ========================================
        */
        .right-column {
            flex: 1;
            /* å æ®å¦ä¸€åŠå®½åº¦ */
            /* [ä¿®æ”¹] è°ƒæ•´å³ä¾§æ å†…è¾¹è· 
               å·¦å³ padding è°ƒæ•´ä¸º 12px (çº¦ 3mm)ï¼Œä¸Šä¸‹ä¿æŒ 0 å’Œ 20px
            */
            padding: 0 12px 20px 12px;
            display: flex;
            flex-direction: column;
            /* å¼ºåˆ¶å†…å®¹é å³å¯¹é½ */
            align-items: flex-end;
        }

        /* å ä½æ ‡é¢˜æ ï¼šç”¨äºä¸å·¦ä¾§æ ‡é¢˜é«˜åº¦å¯¹é½ */
        .preview-header-spacer {
            width: 100%;
            /* åˆå§‹é«˜åº¦ï¼Œä¼šè¢« JS åŠ¨æ€è°ƒæ•´ */
            min-height: 32px;
            margin-bottom: 24px;
            flex-shrink: 0;
        }

        /* é¢„è§ˆåŒºåŸŸåŒ…è£¹å™¨ */
        .preview-area-wrapper {
            flex: 1;
            /* å æ®å‰©ä½™é«˜åº¦ */
            display: flex;
            flex-direction: column;
            justify-content: center;
            /* å‚ç›´å±…ä¸­ */
            /* ç¡®ä¿åŒ…è£¹å™¨å æ»¡å®½åº¦ï¼Œä»¥ä¾¿å†…éƒ¨å¡ç‰‡å¯ä»¥å±…ä¸­æˆ–é å³ */
            width: 100%;
            position: relative;
            /* ä¸ºæˆªå›¾æŒ‰é’®å®šä½åšå‡†å¤‡ */
            /* å¢åŠ åº•éƒ¨å†…è¾¹è·ï¼Œé˜²æ­¢å¡ç‰‡è´´åº• */
            padding-bottom: 40px;
        }

        /* ========================================
        å·¥å…·æ  (Toolbar - Emoji & Controls)
        ========================================
        */
        /* [ä¿®æ”¹] ç§»é™¤ flex å¸ƒå±€ï¼Œè®© Emoji æ ç‹¬å ä¸€è¡Œ */
        .toolbar-container {
            margin-bottom: 12px;
            width: 100%;
        }

        /* [æ–°å¢] æ§ä»¶è¡Œå®¹å™¨ï¼Œç”¨äºæ”¾ç½®ä¸»é¢˜å’Œå­—ä½“é€‰æ‹©ï¼Œç½®äº Emoji ä¸‹æ–¹ */
        .style-controls-row {
            display: flex;
            justify-content: flex-end; /* æ§ä»¶é å³å¯¹é½ */
            margin-bottom: 16px;
        }


        .emoji-bar {
            /* å…è®¸ Emoji æ¢è¡Œ */
            flex-wrap: wrap;
            display: flex;
            gap: 8px;
            padding: 4px;
            background: #f1f5f9;
            border-radius: 8px;
        }

        .emoji-btn {
            font-size: 20px;
            padding: 6px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .emoji-btn:hover {
            background: #e2e8f0;
            transform: scale(1.1);
        }

        .emoji-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .style-controls {
            display: flex;
            gap: 10px;
            flex-shrink: 0;
        }

        .style-select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            color: var(--text-color);
            background: white;
            cursor: pointer;
            outline: none;
        }

        /* ========================================
        å¡ç‰‡æ ·å¼ (Card Styles)
        ========================================
        */
        /* å¡ç‰‡æ•´ä½“å®¹å™¨ */
        .card-container {
            background: white;
            border-radius: 24px;
            /* å¤§åœ†è§’ */
            padding: 40px;
            /* å†…éƒ¨ç•™ç™½ */
            box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.1), 0 10px 20px -5px rgba(0, 0, 0, 0.04);
            /* ä¸°å¯Œçš„é˜´å½± */
            /* [ä¿®æ”¹] å¢åŠ å¡ç‰‡æœ€å¤§å®½åº¦ï¼Œä½¿å…¶æ›´å®½ */
            max-width: 640px;
            width: 100%;
            /* ä¿è¯åœ¨å°å±å¹•ä¸‹è‡ªé€‚åº” */
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        /* å¡ç‰‡é¡¶éƒ¨ä¿¡æ¯æ  */
        .card-header-info {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .card-header-info span {
            display: flex;
            align-items: center;
        }

        .separator {
            margin: 0 12px;
            color: #cbd5e1;
        }

        /* å¡ç‰‡æ ‡é¢˜ */
        .card-title-preview {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 32px;
            line-height: 1.3;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            /* æ ‡é¢˜æ¸å˜è‰² */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* å¡ç‰‡ä¸»ä½“å†…å®¹ */
        .card-body-preview {
            font-size: 17px;
            line-height: 1.8;
            color: #334155;
            white-space: pre-wrap;
            /* ä¿ç•™æ¢è¡Œå’Œç©ºæ ¼ */
        }

        /* å¡ç‰‡åº•éƒ¨ç½²å */
        .card-footer-preview {
            margin-top: 32px;
            padding-top: 24px;
            border-top: 1px solid #f1f5f9;
            font-weight: 600;
            color: #475569;
            display: flex;
            align-items: center;
        }

        .footer-icon {
            margin-right: 8px;
            font-size: 18px;
        }


        /* ========================================
        å¡ç‰‡ä¸»é¢˜å˜ä½“ (Card Themes)
        ========================================
        */
        /* æ·±è‰²ä¸»é¢˜ */
        .card-theme-dark {
            background: #1e293b;
            color: #f8fafc;
        }

        .card-theme-dark .card-title-preview {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .card-theme-dark .card-body-preview {
            color: #cbd5e1;
        }

        .card-theme-dark .card-header-info,
        .card-theme-dark .card-footer-preview {
            color: #94a3b8;
            border-color: #334155;
        }

        /* è“è‰²ä¸»é¢˜ */
        .card-theme-blue {
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
        }

        .card-theme-blue .card-title-preview {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ç»¿è‰²ä¸»é¢˜ */
        .card-theme-green {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }

        .card-theme-green .card-title-preview {
            background: linear-gradient(135deg, #166534 0%, #22c55e 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* ç´«è‰²ä¸»é¢˜ */
        .card-theme-purple {
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
        }

        .card-theme-purple .card-title-preview {
            background: linear-gradient(135deg, #6b21a8 0%, #a855f7 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }


        /* ========================================
        å¡ç‰‡å­—ä½“å˜ä½“ (Card Fonts)
        ========================================
        */
        .font-serif .card-title-preview,
        .font-serif .card-body-preview,
        .font-serif .card-footer-preview {
            font-family: 'Georgia', 'Times New Roman', serif;
        }

        .font-mono .card-title-preview,
        .font-mono .card-body-preview,
        .font-mono .card-footer-preview {
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
        }

        /* ========================================
        å…¶ä»–ç»„ä»¶ (Others)
        ========================================
        */
        /* æˆªå›¾ä¸‹è½½æŒ‰é’® */
        .download-btn {
            position: absolute;
            /* ç»å¯¹å®šä½ */
            bottom: 0;
            /* é ä¸‹ */
            right: 0;
            /* é å³ */
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.2);
            z-index: 10;
            /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
        }

        .download-btn:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(37, 99, 235, 0.3);
        }

        /* å“åº”å¼è®¾è®¡ï¼šå°å±å¹•é€‚é… */
        @media (max-width: 1024px) {
            .main-container {
                flex-direction: column;
                /* ä¸Šä¸‹å¸ƒå±€ */
                height: auto;
                /* é«˜åº¦è‡ªé€‚åº” */
            }

            .left-column,
            .right-column {
                width: 100%;
                /* å æ»¡å®½åº¦ */
            }

            /* å°å±å¹•ä¸‹éšè—å ä½ç¬¦ï¼Œå› ä¸ºä¸å†éœ€è¦å·¦å³å¯¹é½ */
            .preview-header-spacer {
                display: none;
            }

            .preview-area-wrapper {
                padding: 40px 0;
                align-items: center;
                /* å°å±å¹•å±…ä¸­æ˜¾ç¤ºå¡ç‰‡ */
            }

            .card-container {
                margin: 0 auto;
                /* å±…ä¸­ */
            }

            .download-btn {
                position: static;
                /* å–æ¶ˆç»å¯¹å®šä½ */
                width: 100%;
                justify-content: center;
                margin-top: 20px;
            }
        }
    </style>
</head>

<body>
    <div class="main-container">
        <div class="left-column">
            <div class="input-group">
                <label class="input-label">é€‰æ‹©å›¾æ ‡</label>
                <div class="toolbar-container">
                    <div class="emoji-bar" id="emojiBar">
                        </div>
                </div>
                <div class="style-controls-row">
                    <div class="style-controls">
                        <select class="style-select" id="themeSelect">
                            <option value="default">é»˜è®¤ç™½</option>
                            <option value="dark">æ·±è‰²æ¨¡å¼</option>
                            <option value="blue">ç§‘æŠ€è“</option>
                            <option value="green">æ¸…æ–°ç»¿</option>
                            <option value="purple">ä¼˜é›…ç´«</option>
                        </select>
                        <select class="style-select" id="fontSelect">
                            <option value="sans">æ— è¡¬çº¿ä½“</option>
                            <option value="serif">è¡¬çº¿ä½“</option>
                            <option value="mono">ç­‰å®½å­—ä½“</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label class="input-label">å¡ç‰‡æ ‡é¢˜</label>
                <input type="text" id="titleInput" placeholder="è¾“å…¥ä¸€ä¸ªå¸å¼•äººçš„æ ‡é¢˜..." value="Kayler AI å·¥å…·ç«™">
            </div>

            <div class="input-group" style="flex: 1;">
                <label class="input-label">æ­£æ–‡å†…å®¹</label>
                <textarea id="contentInput"
                    placeholder="åœ¨è¿™é‡Œè¾“å…¥ä½ æƒ³è¡¨è¾¾çš„æ ¸å¿ƒè§‚ç‚¹ã€é‡‘å¥æˆ–æ˜¯é‡è¦ä¿¡æ¯...">ä¸“æ³¨äºæä¾›é«˜è´¨é‡çš„ AI å·¥å…·ä¸èµ„æºï¼Œå¸®åŠ©ç”¨æˆ·æ›´é«˜æ•ˆåœ°æ¢ç´¢äººå·¥æ™ºèƒ½çš„ä¸–ç•Œã€‚æ— è®ºä½ æ˜¯åˆå­¦è€…è¿˜æ˜¯ä¸“ä¸šäººå£«ï¼Œè¿™é‡Œéƒ½æœ‰ä½ æ‰€éœ€çš„ä¸€åˆ‡ã€‚</textarea>
            </div>

            <div class="input-group">
                <label class="input-label">åº•éƒ¨ç½²å</label>
                <input type="text" id="footerInput" placeholder="ä¾‹å¦‚ï¼š@ä½ çš„åå­—" value="@Kayler AI">
            </div>
        </div>

        <div class="right-column">
            <div class="preview-header-spacer"></div>
            <div class="preview-area-wrapper" id="previewWrapper">
                <div class="card-container" id="preview-card">
                    <div class="card-header-info">
                        <span id="cardDate">2024.03.21</span>
                        <span class="separator">|</span>
                        <span>INSIGHTS</span>
                    </div>
                    <div class="card-title-preview" id="cardTitle">Kayler AI å·¥å…·ç«™</div>
                    <div class="card-body-preview" id="cardContent">ä¸“æ³¨äºæä¾›é«˜è´¨é‡çš„ AI å·¥å…·ä¸èµ„æºï¼Œå¸®åŠ©ç”¨æˆ·æ›´é«˜æ•ˆåœ°æ¢ç´¢äººå·¥æ™ºèƒ½çš„ä¸–ç•Œã€‚æ— è®ºä½ æ˜¯åˆå­¦è€…è¿˜æ˜¯ä¸“ä¸šäººå£«ï¼Œè¿™é‡Œéƒ½æœ‰ä½ æ‰€éœ€çš„ä¸€åˆ‡ã€‚</div>
                    <div class="card-footer-preview">
                        <span class="footer-icon" id="footerIcon">âœ¨</span>
                        <span id="cardFooter">@Kayler AI</span>
                    </div>
                </div>
                <button class="download-btn" id="downloadBtn">
                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" />
                    </svg>
                    ç”Ÿæˆå¡ç‰‡å›¾ç‰‡
                </button>
            </div>
        </div>
    </div>

    <script>
        // å®šä¹‰ Emoji åˆ—è¡¨
        const emojis = [
            'âœ¨', 'ğŸ’¡', 'ğŸš€', 'ğŸ¯', 'ğŸ”¥', 'â­', 'ğŸŒŸ', 'ğŸ“', 'ğŸ“š', 'ğŸ¨',
            'ğŸ¬', 'ğŸ¤', 'ğŸ§', 'ğŸ®', 'ğŸ§©', 'ğŸ²', 'â™Ÿï¸', 'ğŸ³', 'ğŸ¥Š', 'ğŸ†',
            'ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', 'ğŸ…', 'ğŸ–ï¸', 'ğŸ—ï¸', 'ğŸŸï¸', 'ğŸ«', 'ğŸº', 'ğŸ»',
            'ğŸª•', 'ğŸ¸', 'ğŸ·', 'ğŸ¹', 'ğŸ¼', 'ğŸ§', 'ğŸ¤', 'ğŸ¬', 'ğŸ¨', 'ğŸ­',
            'ğŸª', 'ğŸ«', 'ğŸŸï¸', 'ğŸ—ï¸', 'ğŸ–ï¸', 'ğŸ…', 'ğŸ¥‰', 'ğŸ¥ˆ', 'ğŸ¥‡', 'ğŸ†'
        ];

        // è·å– DOM å…ƒç´ 
        const emojiBar = document.getElementById('emojiBar');
        const titleInput = document.getElementById('titleInput');
        const contentInput = document.getElementById('contentInput');
        const footerInput = document.getElementById('footerInput');
        const themeSelect = document.getElementById('themeSelect');
        const fontSelect = document.getElementById('fontSelect');

        const cardTitle = document.getElementById('cardTitle');
        const cardContent = document.getElementById('cardContent');
        const cardFooter = document.getElementById('cardFooter');
        const footerIcon = document.getElementById('footerIcon');
        const previewCard = document.getElementById('preview-card');
        const cardDate = document.getElementById('cardDate');

        // åˆå§‹åŒ–å‡½æ•°
        function init() {
            renderEmojis();
            setupEventListeners();
            updateDate();
            // é¡µé¢åŠ è½½å®Œæˆåï¼ŒåŒæ­¥ä¸€æ¬¡é«˜åº¦
            setTimeout(syncHeaderHeights, 100);
        }

        // æ ¸å¿ƒåŠŸèƒ½ï¼šåŒæ­¥å·¦å³ä¸¤ä¾§æ ‡é¢˜æ çš„é«˜åº¦
        function syncHeaderHeights() {
            // è·å–å·¦ä¾§ Emoji æ å’Œå…¶ä¸Šæ–¹ Label çš„æ€»é«˜åº¦
            const leftLabel = document.querySelector('.left-column .input-label'); // è·å–ç¬¬ä¸€ä¸ª label (é€‰æ‹©å›¾æ ‡)
            const toolbarContainer = document.querySelector('.toolbar-container'); // è·å–åŒ…å« Emoji çš„å®¹å™¨
            const styleControlsRow = document.querySelector('.style-controls-row'); // è·å–åŒ…å«æ§ä»¶çš„å®¹å™¨
            // [ä¿®æ”¹] 
            // è®¡ç®—å·¦ä¾§é¡¶éƒ¨åŒºåŸŸçš„æ€»é«˜åº¦ = Labelé«˜åº¦ + Labelä¸‹è¾¹è· + Emojiå®¹å™¨é«˜åº¦ + Emojiå®¹å™¨ä¸‹è¾¹è· + æ§ä»¶è¡Œé«˜åº¦ + æ§ä»¶è¡Œä¸‹è¾¹è·
            // ä½¿ç”¨ offsetHeight è·å–å…ƒç´ çš„å®é™…æ¸²æŸ“é«˜åº¦
            const totalHeaderHeight =
                leftLabel.offsetHeight + 8 + // Label é«˜åº¦ + margin-bottom: 8px
                toolbarContainer.offsetHeight + 12 + // Emoji å®¹å™¨é«˜åº¦ + margin-bottom: 12px
                styleControlsRow.offsetHeight + 16;  // æ§ä»¶è¡Œé«˜åº¦ + margin-bottom: 16px

            // è·å–å³ä¾§çš„å ä½ç¬¦å…ƒç´ 
            const rightSpacer = document.querySelector('.preview-header-spacer');

            // å°†è®¡ç®—å‡ºçš„é«˜åº¦èµ‹å€¼ç»™å³ä¾§å ä½ç¬¦
            if (rightSpacer) {
                // å‡å»å³ä¾§å ä½ç¬¦è‡ªèº«çš„ margin-bottom (24px)ï¼Œç¡®ä¿çº¢çº¿å¯¹é½
                rightSpacer.style.height = (totalHeaderHeight - 24) + 'px';
            }
        }

        // æ¸²æŸ“ Emoji æŒ‰é’®åˆ—è¡¨
        function renderEmojis() {
            emojis.forEach((emoji, index) => {
                const btn = document.createElement('button');
                btn.className = `emoji-btn ${index === 0 ? 'active' : ''}`; // é»˜è®¤é€‰ä¸­ç¬¬ä¸€ä¸ª
                btn.textContent = emoji;
                btn.onclick = () => selectEmoji(btn, emoji);
                emojiBar.appendChild(btn);
            });
        }

        // åˆ‡æ¢é€‰ä¸­çš„ Emoji
        function selectEmoji(btn, emoji) {
            document.querySelectorAll('.emoji-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            footerIcon.textContent = emoji;
        }

        // æ›´æ–°å¡ç‰‡ä¸Šçš„æ—¥æœŸ
        function updateDate() {
            const now = new Date();
            cardDate.textContent = now.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            }).replace(/\//g, '.');
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨ï¼Œå®ç°å®æ—¶é¢„è§ˆ
        function setupEventListeners() {
            // ç›‘å¬è¾“å…¥æ¡†å˜åŒ–
            titleInput.addEventListener('input', (e) => cardTitle.textContent = e.target.value || 'å¡ç‰‡æ ‡é¢˜');
            contentInput.addEventListener('input', (e) => cardContent.textContent = e.target.value || 'å¡ç‰‡å†…å®¹...');
            footerInput.addEventListener('input', (e) => cardFooter.textContent = e.target.value || '@ç½²å');

            // ç›‘å¬ä¸»é¢˜å’Œå­—ä½“åˆ‡æ¢
            themeSelect.addEventListener('change', (e) => {
                // ç§»é™¤æ‰€æœ‰æ—§ä¸»é¢˜ç±»å
                previewCard.classList.remove('card-theme-dark', 'card-theme-blue', 'card-theme-green', 'card-theme-purple');
                // å¦‚æœä¸æ˜¯é»˜è®¤ä¸»é¢˜ï¼Œæ·»åŠ æ–°ä¸»é¢˜ç±»å
                if (e.target.value !== 'default') {
                    previewCard.classList.add(`card-theme-${e.target.value}`);
                }
            });

            fontSelect.addEventListener('change', (e) => {
                // ç§»é™¤æ‰€æœ‰æ—§å­—ä½“ç±»å
                previewCard.classList.remove('font-serif', 'font-mono');
                // å¦‚æœä¸æ˜¯é»˜è®¤å­—ä½“ï¼Œæ·»åŠ æ–°å­—ä½“ç±»å
                if (e.target.value !== 'sans') {
                    previewCard.classList.add(`font-${e.target.value}`);
                }
            });

            // [ä¿®æ”¹] ç›‘å¬çª—å£å¤§å°å˜åŒ–å’Œ Emoji æ çš„ä»»ä½•å˜åŒ–ï¼Œé‡æ–°åŒæ­¥é«˜åº¦
            // ä½¿ç”¨ ResizeObserver ç›‘å¬ toolbar-container çš„é«˜åº¦å˜åŒ–æ˜¯æ›´å¥å£®çš„æ–¹æ³•
            const resizeObserver = new ResizeObserver(() => {
                syncHeaderHeights();
            });
            resizeObserver.observe(document.querySelector('.toolbar-container'));
            // åŒæ—¶ç›‘å¬çª—å£ resize ä½œä¸ºåå¤‡
            window.addEventListener('resize', syncHeaderHeights);


            // æˆªå›¾ä¸‹è½½åŠŸèƒ½
            document.getElementById('downloadBtn').addEventListener('click', async () => {
                const btn = document.getElementById('downloadBtn');
                const originalText = btn.innerHTML;
                btn.innerHTML = 'âœ¨ ç”Ÿæˆä¸­...'; // æ›´æ–°æŒ‰é’®çŠ¶æ€
                btn.disabled = true;

                try {
                    // ä½¿ç”¨ html2canvas ç”Ÿæˆå›¾ç‰‡
                    const canvas = await html2canvas(previewCard, {
                        scale: 2, // 2å€æ¸…æ™°åº¦
                        backgroundColor: null, // é€æ˜èƒŒæ™¯
                        logging: false // å…³é—­æ—¥å¿—
                    });

                    // åˆ›å»ºä¸‹è½½é“¾æ¥
                    const link = document.createElement('a');
                    link.download = `kayler-card-${Date.now()}.png`;
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (err) {
                    console.error('ç”Ÿæˆå¤±è´¥:', err);
                    alert('ç”Ÿæˆå›¾ç‰‡å¤±è´¥ï¼Œè¯·é‡è¯•');
                } finally {
                    // æ¢å¤æŒ‰é’®çŠ¶æ€
                    btn.innerHTML = originalText;
                    btn.disabled = false;
                }
            });
        }

        // å¯åŠ¨åˆå§‹åŒ–
        init();
    </script>
</body>

</html>