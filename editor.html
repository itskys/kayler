<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kayler 在线编辑器</title>
    <link rel="stylesheet" href="editor.css?v=6.1">
    <link rel="icon" href="logo.png" type="image/png">
    
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <div class="main-wrapper">
        
        <div class="editor-toolbar-header">
            <div class="page-title">
                <img src="logo.png" alt="Kayler Logo" style="height: 32px; width: auto; margin-right: 10px;">
                <span>Kayler在线编辑器</span>
            </div>

            <input type="text" class="title-input" id="file-name-input" value="Role 资深法医级人体分析师 & 顶级ACG概念艺术家.md">

            <div class="action-group">
                <button class="btn btn-setting" id="btn-setting"><i class="fa-solid fa-gear"></i> 设置</button>
                <button class="btn btn-save" id="btn-save"><i class="fa-solid fa-cloud-arrow-up"></i> 保存并发布</button>
                <button class="btn btn-pdf" id="btn-pdf"><i class="fa-solid fa-file-pdf"></i> PDF (A4)</button>
                <button class="btn btn-md" id="btn-md"><i class="fa-solid fa-file-arrow-down"></i> .md</button>
                <button class="btn btn-long" id="btn-long-img"><i class="fa-solid fa-image"></i> 长图</button>
            </div>
        </div>

        <div class="editor-container">
            <div class="panel">
                <div class="panel-header">
                    <span><i class="fa-brands fa-markdown"></i> Markdown 源码</span>
                    <button id="btn-copy-code" class="copy-btn">复制代码</button>
                </div>
                <textarea id="editor" class="editor-area" placeholder="# 欢迎使用..."></textarea>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <span><i class="fa-solid fa-eye"></i> 实时预览</span>
                    <button id="btn-copy-text" class="copy-btn">复制文本</button>
                </div>
                <div id="preview" class="preview-area"></div>
            </div>
        </div>
    </div>

    <script src="markdown-data.js"></script>
    <script src="layout.js"></script>
    <script src="editor.js?v=6.1"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ... (读取缓存等逻辑) ...

            // 核心：调用 editor.js 暴露的初始化函数
            if (typeof window.initEditor === 'function') {
                window.initEditor();
            }
            
            // 手动触发一次渲染
            if (typeof window.updatePreview === 'function') {
                window.updatePreview();
            }
            
            console.log("Kayler Editor 初始化完成");
        });
    </script>

</body>
</html>